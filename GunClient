local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

local flySpeed = 5  -- Tá»‘c Ä‘á»™ máº·c Ä‘á»‹nh
local maxFlySpeed = 50 -- Giá»›i háº¡n tá»‘c Ä‘á»™
local acceleration = 2  -- Tá»‘c Ä‘á»™ tÄƒng dáº§n

-- ðŸš€ Táº¡o BodyVelocity vÃ  BodyGyro
local bodyVelocity = Instance.new("BodyVelocity")
bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
bodyVelocity.Parent = humanoidRootPart

local bodyGyro = Instance.new("BodyGyro")
bodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
bodyGyro.Parent = humanoidRootPart

humanoid.PlatformStand = true

RunService.RenderStepped:Connect(function()
    -- Giá»¯ nhÃ¢n váº­t tháº³ng vá»›i hÆ°á»›ng camera
    bodyGyro.CFrame = workspace.CurrentCamera.CFrame

    -- Láº¥y hÆ°á»›ng di chuyá»ƒn vÃ  camera
    local cameraCF = workspace.CurrentCamera.CFrame
    local moveVector = humanoid.MoveDirection
    local lookVector = cameraCF.LookVector
    
    -- TÃ­nh toÃ¡n váº­n tá»‘c
    local velocity = Vector3.new(0, 0, 0)
    
    if moveVector.Magnitude > 0 then
        flySpeed = math.min(flySpeed + acceleration, maxFlySpeed)
        
        -- TÃ­nh dot product Ä‘á»ƒ xÃ¡c Ä‘á»‹nh hÆ°á»›ng di chuyá»ƒn tÆ°Æ¡ng Ä‘á»‘i vá»›i camera
        local dotProduct = moveVector:Dot(lookVector)
        
        -- Ãp dá»¥ng chuyá»ƒn Ä‘á»™ng ngang vÃ  dá»c
        local verticalComponent = lookVector.Y * flySpeed * (dotProduct > 0 and 1 or -1)
        velocity = moveVector * flySpeed
        velocity = velocity + Vector3.new(0, verticalComponent, 0)
    else
        flySpeed = 5
    end
    
    bodyVelocity.Velocity = velocity
end)
